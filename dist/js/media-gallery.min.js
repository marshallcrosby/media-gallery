/*!
    * Media Gallery v1.0.0
    * Display media in a Swiper slider inside a Bootstrap modal.
    *
    * Copyright 2024 Blend Interactive
    * https://blendinteractive.com
*/
const swiperVersion="11.0.5",externalSrc={youtube:"https://www.youtube.com/iframe_api",vimeo:"https://player.vimeo.com/api/player.js",swiperScript:"https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js",swiperCSS:"https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"},mediaGallery=()=>{const e=(e,t,o)=>{const i="script"===t?document.createElement("script"):document.createElement("link"),d="script"===t?"src":"href";"stylesheet"===t&&i.setAttribute("rel","stylesheet"),i.setAttribute(d,e),"script"===t?document.body.appendChild(i):"stylesheet"===t&&document.querySelector("head").appendChild(i),i.onload=o},t=document.querySelectorAll(".media-gallery__item"),o=window.getComputedStyle(document.documentElement).getPropertyValue("--swiper-theme-color");t&&(o||e(externalSrc.swiperCSS,"stylesheet"),"undefined"==typeof Swiper&&e(externalSrc.swiperScript,"script"));const i=document.querySelector(".media-viewer__swiper"),d=i.querySelector(".media-viewer__wrapper"),r=e=>{let t={vendor:null,id:null};if(e.includes("vimeo.com")){const o=/\/(?:playback\/)?(\d+)/,i=e.match(o);if(i&&i[1])return t={vendor:"vimeo",id:i[1]}}const o=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);return o&&o[1]?t={vendor:"youtube",id:o[1]}:t},n=document.querySelectorAll("[data-video-src]");let a=null,l=null;for(const e of n){let t=r(e.getAttribute("data-video-src"));"youtube"===t.vendor&&(a=!0),"vimeo"===t.vendor&&(l=!0)}if(a){document.querySelectorAll('script[src="https://www.youtube.com/iframe_api"]').length||e(externalSrc.youtube,"script"),onYouTubeIframeAPIReady=(()=>{s++,console.log("Youtube API Ready")})}if(l){document.querySelectorAll('script[src="https://player.vimeo.com/api/player.js"]').length||e(externalSrc.vimeo,"script")}let s=0,c=0;a&&(c=1);let u=new Event("mediaReadyEvent"),p=0;const m=(e,t)=>{const o="vimeoPlayer"+Math.floor(1e9*Math.random());e.setAttribute("id",o),e.classList.add("vimeo-player");const d=new Vimeo.Player(o,{id:t});d.on("loaded",()=>{console.log(p),i.swiper.on("slideChange",()=>{d.pause()}),window.addEventListener("mediaModalClosedEvent",()=>{d.pause()});const t=e.closest(".swiper-slide-active");0===p&&t&&window.dispatchEvent(u),p++})};let v=0;const w=(e,t)=>{const o="ytPlayer"+Math.floor(1e9*Math.random());let d;e.setAttribute("id",o),e.classList.add("yt-player"),d=new YT.Player(o,{videoId:t,height:"20000",width:"20000",playerVars:{autoplay:0,controls:1,showinfo:0,rel:0},events:{onReady:function(){i.swiper.on("slideChange",()=>{d.pauseVideo()}),window.addEventListener("mediaModalClosedEvent",()=>{d.pauseVideo()});const t=e.closest(".swiper-slide-active");0===v&&t&&(console.log("found"),window.dispatchEvent(u));v++}}})};let y=0;const h=(e,t,o)=>{const d="html5VideoPlayer"+Math.floor(1e9*Math.random());e.classList.add("html5-video-player"),e.setAttribute("id",d),e.setAttribute("controls",""),e.setAttribute("playsinline",""),e.setAttribute("poster",o),e.innerHTML=`\n            <source src="${t}" type="video/mp4">\n            Your browser does not support the video tag.\n        `,e.addEventListener("loadstart",()=>{i.swiper.on("slideChange",()=>{e.pause()}),window.addEventListener("mediaModalClosedEvent",()=>{e.pause()});const t=e.closest(".swiper-slide-active");0===y&&t&&window.dispatchEvent(u),y++})};let b,E;document.querySelectorAll(".media-gallery").forEach(e=>{e.setAttribute("data-group-id","mediaGallery-"+Math.floor(1e9*Math.random()));const t=e.querySelectorAll(".media-gallery__item"),o=document.createElement("div");o.classList.add("media-viewer__slide"),o.classList.add("swiper-slide"),t.forEach((n,a)=>{n.setAttribute("role","button"),n.setAttribute("tabindex","0"),n.setAttribute("aria-label","View media"),n.addEventListener("click",l=>{if(E!==e.getAttribute("data-group-id")){d.children.length>0&&(e=>{e&&(e.swiper.destroy(!0,!0),e.querySelectorAll(".media-viewer__slide").forEach(e=>e.remove()))})(i);for(const e of t){const t=o.cloneNode(!0),i=e.getAttribute("data-video-src"),n=e.querySelector(".media-gallery__media"),a=n?n.cloneNode(!0):null;if(a&&t.appendChild(a),d.appendChild(t),i){const e=r(i),o=null!==e.vendor?document.createElement("div"):document.createElement("video");t.appendChild(o),"youtube"===e.vendor&&w(o,e.id),"vimeo"===e.vendor&&m(o,e.id),null===e.vendor&&h(o,i,a.src),a&&a.remove()}}(e=>{const t=new Swiper(".media-viewer__swiper",{autoHeight:!0,speed:400,spaceBetween:4,navigation:{prevEl:".media-viewer__button-prev",nextEl:".media-viewer__button-next"},pagination:{el:".media-viewer__slide-status",type:"fraction"},keyboard:{enabled:!0}});e&&t.slideTo(e,0,!1)})(a)}else i.swiper.slideTo(a,0,!1);b=n,E=e.getAttribute("data-group-id"),i.querySelector(".swiper-slide-active img")&&window.dispatchEvent(u)}),n.addEventListener("keydown",e=>{"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),e.stopPropagation(),e.target.click())})})});const g=document.querySelector(".modal--media .bar-loader"),f=document.getElementById("mediaModal");document.body.appendChild(f),f.addEventListener("shown.bs.modal",()=>{setTimeout(()=>{g.classList.add("bar-loader--hidden")},1e3),window.addEventListener("mediaReadyEvent",()=>{console.log("loading done")})});let S=new Event("mediaModalClosedEvent");f.addEventListener("hidden.bs.modal",()=>{window.dispatchEvent(S),setTimeout(()=>{g.classList.remove("bar-loader--hidden"),b.focus()},5)}),function e(){s!==c?setTimeout(e,300):document.documentElement.classList.add("js-media-gallery--ready")}()};
//# sourceMappingURL=media-gallery.min.js.map